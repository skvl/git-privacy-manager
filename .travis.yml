dist: xenial
language: python
python:
  - "3.7"
before_install:
  - sudo apt-get install -y gnupg
install:
  - pip install pipenv
  - pipenv install -d -v

matrix:
  include:

  - env:
    - TEST="unittest"
    script:
        - python setup.py test

  - env:
    - TEST="SonarCloud"
    addons:
      sonarcloud:
        organization: "skvl-github"
        token:
          secure: "$SONAR_TOKEN"
    install:
      - pip install pipenv
      - pipenv install -d -v
      - pip install codecov
    script:
      - coverage run ./setup.py test
      - coverage xml -i -o coverage.xml
      - sonar-scanner -Dsonar.python.coverage.reportPath=./coverage.xml

  - env:
    - TEST="codecov"
    install:
      - pip install pipenv
      - pipenv install -d -v
      - pip install codecov
    script:
      - coverage run ./setup.py test
    after_success:
      - codecov
